<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Refinments and extensions of thr Central Limit Theorem – MA1AY010 Class Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-gaussian-vectors.html" rel="next">
<link href="./08-convergence-3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-3a70adc2469c323d0515427c5f9cb542.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MA1AY010 Class Notes</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="./MA1AY010-Class-Notes.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08-convergence-3b.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Refinments and extensions of thr Central Limit Theorem</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Warm up</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-language.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A modicum of measure theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./031-moments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A modicum of integration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Families of discrete distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./023-discrete-condition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discrete Conditioning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./032-acfamilies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Absolutely continuous probability measures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-characterizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Characterizations of probability distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-conditioning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Conditioning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-convergences-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Convergences I : almost sure, <span class="math inline">\(L_2\)</span>, <span class="math inline">\(L_1\)</span>, in Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-convergence-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Convergence in distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-convergence-3b.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Refinments and extensions of thr Central Limit Theorem</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-gaussian-vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Gaussian vectors</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation"><span class="header-section-number">11.1</span> Motivation</a></li>
  <li><a href="#sec-cltbis" id="toc-sec-cltbis" class="nav-link" data-scroll-target="#sec-cltbis"><span class="header-section-number">11.2</span> Central limit theorem</a></li>
  <li><a href="#cramer-wold-device" id="toc-cramer-wold-device" class="nav-link" data-scroll-target="#cramer-wold-device"><span class="header-section-number">11.3</span> Cramer-Wold device</a></li>
  <li><a href="#sec-MetrisationWeakConv" id="toc-sec-MetrisationWeakConv" class="nav-link" data-scroll-target="#sec-MetrisationWeakConv"><span class="header-section-number">11.4</span> Metrizations of weak convergence</a>
  <ul class="collapse">
  <li><a href="#wasserstein-distance" id="toc-wasserstein-distance" class="nav-link" data-scroll-target="#wasserstein-distance"><span class="header-section-number">11.4.1</span> Wasserstein distance</a></li>
  </ul></li>
  <li><a href="#sec-steinsmethod" id="toc-sec-steinsmethod" class="nav-link" data-scroll-target="#sec-steinsmethod"><span class="header-section-number">11.5</span> Stein’s method</a>
  <ul class="collapse">
  <li><a href="#steins-identity" id="toc-steins-identity" class="nav-link" data-scroll-target="#steins-identity"><span class="header-section-number">11.5.1</span> Stein’s Identity</a></li>
  </ul></li>
  <li><a href="#sec-secBerryLindeberg" id="toc-sec-secBerryLindeberg" class="nav-link" data-scroll-target="#sec-secBerryLindeberg"><span class="header-section-number">11.6</span> A Berry-Esseen bound for a Lindeberg-Feller-like Central Limit Theorem</a></li>
  <li><a href="#bibliographic-remarks" id="toc-bibliographic-remarks" class="nav-link" data-scroll-target="#bibliographic-remarks"><span class="header-section-number">11.7</span> Bibliographic remarks</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-chaprevisiCLT" class="quarto-section-identifier"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Refinments and extensions of thr Central Limit Theorem</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="motivation" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="motivation"><span class="header-section-number">11.1</span> Motivation</h2>
<p>In <a href="#sec-MetrisationWeakConv" class="quarto-xref">Section&nbsp;<span>11.4</span></a>), we associate convergence in distribution with metrics. By metrizing convergence in distribution, we can quantify rates of convergence.</p>
<p>In <a href="#sec-steinsmethod" class="quarto-xref">Section&nbsp;<span>11.5</span></a>) we turn a relatively recent approach to weak convergence: Stein’s method. This is best illustrated with variations on the Central Limit Theorem. Recall that a byproduct of the proof that characteristic functions identify probability distributions was Stein’s identity.</p>
</section>
<section id="sec-cltbis" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sec-cltbis"><span class="header-section-number">11.2</span> Central limit theorem</h2>
<div id="thm">
<p>Let <span class="math inline">\(X_1, \ldots, X_n, \ldots\)</span> be i.i.d. with finite variance <span class="math inline">\(\sigma^2\)</span> and expectation <span class="math inline">\(\mu\)</span>. Let <span class="math inline">\(S_n = \sum_{i=1}^n X_i\)</span>.</p>
<p><span class="math display">\[
\sqrt{n} \left(\frac{S_n}{n} - \mu \right) \rightsquigarrow \mathcal{N}\big(0, \sigma^2 \big) \, .
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>TODO</p>
<p><span class="math inline">\(\square\)</span></p>
</div>
<!-- ::: {#fig-cltbinom} -->
<div class="cell">
<div class="cell-output-display">
<div id="fig-cltbinom" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-cltbinom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-convergence-3b_files/figure-html/fig-cltbinom-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-cltbinom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.1: Pointwise convergence of cumulative distribution functions towards the Gaussian cumulative distribution functions of <span class="math inline">\(\mathcal{N}(0,1)\)</span> (plain line) illustrates the Central Limit Theorem. The dotted and the dashed lines represent the cumulative distribution function of <span class="math inline">\((X_n -np)/\sqrt{n(p*(1-p))}\)</span> where <span class="math inline">\(X_n \sim \text{Binomial}(n,p)\)</span> for <span class="math inline">\(p=.3\)</span> and <span class="math inline">\(n=30 \text(dotted), 100 \text(dashed)\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<!-- :::  -->
</section>
<section id="cramer-wold-device" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="cramer-wold-device"><span class="header-section-number">11.3</span> Cramer-Wold device</h2>
<p>The next theorem is a corollary of <span class="quarto-unresolved-ref">?thm-thmLevyInj</span>).</p>
<div id="thm-cramerwold" class="theorem">
<p><span class="theorem-title"><strong>Theorem 11.1 (Cramer-Wold)</strong></span> The distribution of a <span class="math inline">\(\mathbb{R}^n\)</span>-valued random vector <span class="math inline">\(X = (X_1, \ldots, X_n)^T\)</span> is completely determined by the collection of distributions of univariate random variables <span class="math inline">\(\langle t, X\rangle =\sum_{i=1}^n t_i X_i\)</span> where <span class="math inline">\((t_1, \ldots, t_n)^T\)</span> belongs to <span class="math inline">\(\mathbb{R}^n.\)</span></p>
</div>
</section>
<section id="sec-MetrisationWeakConv" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="sec-MetrisationWeakConv"><span class="header-section-number">11.4</span> Metrizations of weak convergence</h2>
<p>When we talk about laws on complete separable metric spaces, convergence in distribution can be defined in relation to a distance. In fact, several distances are possible and you can choose any of them according to your needs. The distances we are interested in are of the form <span class="math display">\[
\mathrm{d}_{\mathcal{H}}(P, Q) = \sup_{h \in \mathcal{H}}
\int h \mathrm{d}P - \int h \mathrm{d}Q
\]</span> where <span class="math inline">\(\mathcal{H}\)</span> is a well-chosen collection of measurable functions.</p>
<p>The Kolmogorov-Lévy metric is used implicitly in the formulation of Glivenko-Cantelli’s theorem, it is controlled in the inequality of Dvoretzky-Kiefer-Wolfowitz.</p>
<div id="def-defKolLev" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 11.1 (Kolmogorov-Lévy distance)</strong></span> If <span class="math inline">\(W\)</span> and <span class="math inline">\(Z\)</span> are two real random variables, the Kolmogorov-Lévy distance between their distributions is defined by <span class="math display">\[
\mathrm{d}_K(\mathcal{L}(W), \mathcal{L}(Z)) =  \sup_{x \in \mathbb{R}} \left| \mathbb{P}\{ W \leq x\} - \mathbb{P}\{ Z \leq x\} \right| \, .
\]</span></p>
</div>
<p>The fact that the Kolmogorov-Lévy distance metrizes the weak convergence towards a limiting distribution with a continuous cumulative distribution function is checked with the argument used in the classical proofs of Glivenko-Cantelli’s theorem.</p>
<p>If <span class="math inline">\(\lim_n x_n x_n = x\)</span>, the mass sequence <span class="math inline">\(\delta_{x_n}\)</span> converges weakly towards the mass <span class="math inline">\(\delta_x\)</span>, however, if <span class="math inline">\(x_n \neq x\)</span>, <span class="math inline">\(\mathrm{d}_K(\delta_{x_n}, \delta_x)=1\)</span>.</p>
<p>To metrize weak convergence in general settings, we can use the Levy-Prokhorov distance:</p>
<p><span class="math display">\[
\inf \Big\{\epsilon : \epsilon &gt;0,   \qquad  P(-\infty, x-\epsilon] -\epsilon \leq Q(-\infty, x] \leq P(-\infty, x-\epsilon] + \epsilon\Big\} \, .
\]</span></p>
<p>The Kolmogorov-Lévy distance represents a relevant relaxation of the total variation distance (which does not metrize convergence in distribution). The fact that the test functions which define the Kolmogorov-Lévy distance are not absolutely continuous does not make life any easier. That is why we often work with a distance defined by more user-friendly functions. This distance belongs to the family of distances known as Monge-Wasserstein distances, or transportation distance.</p>
<div id="def">
<section id="wasserstein-distance" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="wasserstein-distance"><span class="header-section-number">11.4.1</span> Wasserstein distance</h3>
<p>Let <span class="math inline">\(W\)</span> and <span class="math inline">\(Z\)</span> be <span class="math inline">\(\mathbb{R}^k\)</span>-valued random variables with distributions <span class="math inline">\(\mathcal{L}(W)\)</span>, <span class="math display">\[
\mathrm{d}_M(\mathcal{L}(W), \mathcal{L}(Z)) =  \sup_{h: 1-\text{Lipschitz}} \left| \mathbb{E} h(W) - \mathbb{E} h(Z) \right| \, .
\]</span></p>
</section>
</div>
<p>When we want to evaluate the distance with respect to an absolutely continuous distribution like the Gaussian distribution, the use of one metric over another is not very important.</p>
<div id="prp">
<p>Si <span class="math inline">\(P\)</span> et <span class="math inline">\(Q\)</span> sont deux lois sur <span class="math inline">\(\mathbb{R}\)</span>, et si <span class="math inline">\(Q\)</span> possède une densité majorée par <span class="math inline">\(C\)</span> vis-à-vis de la mesure de Lebesgue, alors</p>
<p><span class="math display">\[
\mathrm{d}_K(P,Q) \leq \sqrt{ 2 C \mathrm{d}_{M}(P,Q)} \, .
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Pour <span class="math inline">\(x \in \mathbb{R}\)</span>, on note <span class="math inline">\(h_x = \mathbb{I}_{(-\infty,x]}\)</span> et pour <span class="math inline">\(\epsilon&gt;0\)</span>, on définit <span class="math inline">\(h_{x, \epsilon}\)</span> par</p>
<p><span class="math display">\[ h_{x,\epsilon}(w) =
  \begin{cases}
  1 &amp; \text{si } x\geq w\\
  0 &amp; \text{si } w&gt; x + \epsilon \\
  1 - \frac{w-x}{\epsilon}  &amp; \text{si } x\leq w \leq x+ \epsilon
  \end{cases}
\]</span></p>
<p>On note <span class="math inline">\(q\)</span> la densité de <span class="math inline">\(Q\)</span> par rapport à la mesure de Lebesgue. La fonction <span class="math inline">\(h_{x,\epsilon}\)</span> est <span class="math inline">\(1/\epsilon\)</span>-Lipschitz et elle approche <span class="math inline">\(h_x\)</span>. Si <span class="math inline">\(W \sim P\)</span> et <span class="math inline">\(Z \sim Q\)</span>, <span class="math display">\[\begin{align*}
  \mathbb{E} h_x(W) - \mathbb{E} h_x(Z)
  &amp; = \underbrace{\mathbb{E} h_x(W) - \mathbb{E} h_{x,\epsilon} (Z)}_{\textsf{(i)}}  +
  \underbrace{\mathbb{E} h_{x, \epsilon}(Z) - \mathbb{E} h_x(Z)}_{\textsf{(II)}} \,.
\end{align*}\]</span> On majore ensuite (simplement) les deux expressions et . <span class="math display">\[\begin{align*}
\textsf{(i)} &amp; \leq \mathbb{E} h_{x,\epsilon} (W) - \mathbb{E} h_{x,\epsilon} (Z)\\
&amp; \leq \frac{1}{\epsilon} \mathrm{d}_{M}(P,Q) \,
\end{align*}\]</span> et <span class="math display">\[\begin{align*}
\textsf{(ii)} &amp; \leq \int_{x}^{x+\epsilon}\left(1 - \frac{w-x}{\epsilon} \right) q(z)\mathrm{d}z\\
&amp; \leq C \frac{\epsilon}{2} \, .
\end{align*}\]</span> En choisissant <span class="math inline">\(\epsilon = \sqrt{2\mathrm{d}_{M}(P,Q)/C}\)</span>, et en optimisant le choix de <span class="math inline">\(x\)</span>, on obtient le résultat désiré.</p>
<p><span class="math inline">\(\square\)</span></p>
</div>
</section>
<section id="sec-steinsmethod" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="sec-steinsmethod"><span class="header-section-number">11.5</span> Stein’s method</h2>
<p>In Stein’s approach, we are interested in the approximation of a target law (normal law, Fish, <span class="math inline">\(\chi^2_k\)</span>, ) by the law of a random variable whose mode of manufacturing (sum of independent random variables, order statistics, logarithm of likelihood ratio,…). The target law is characterized by an identity. In the case of of normal law, it’s Stein’s identity.</p>
<div id="lem">
<section id="steins-identity" class="level3" data-number="11.5.1">
<h3 data-number="11.5.1" class="anchored" data-anchor-id="steins-identity"><span class="header-section-number">11.5.1</span> Stein’s Identity</h3>
<p>Let the real random variable <span class="math inline">\(Z\)</span> be distributed according to <span class="math inline">\(Q\)</span>. if for every absolutely continuous function <span class="math inline">\(f\)</span> such that <span class="math inline">\(f'(Z)\)</span> is <span class="math inline">\(Q\)</span>-integrable, we have <span class="math display">\[\mathbb{E}[Z f(Z)] = \mathbb{E}[f'(Z)]\]</span> then <span class="math display">\[Q = \mathcal{N}(0,1) \, .\]</span> The converse is true.</p>
</section>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>See <a href="09-gaussian-vectors.html#lem-steinslemma" class="quarto-xref">Lemma&nbsp;<span>12.1</span></a> and <span class="quarto-unresolved-ref">?lem-steinslemma-bis</span>.</p>
</div>
<p>This identity leads us to define an operator <span class="math inline">\(\mathcal{A}\)</span> that acts on absolutely continuous functions: <span class="math inline">\(\mathcal{A} f(x) = f'(x) - x f(x)\)</span>. This operator allows us to characterize <span class="math inline">\(\mathcal{N}(0,1)\)</span>: <span class="math display">\[
Q = \mathcal{N}(0,1) \Longleftrightarrow \forall f \text{a.c}\quad 0 = \int \mathcal{A}f(z) Q(\mathrm{d}z) \, .
\]</span></p>
<p>Now, for function <span class="math inline">\(h \in \mathcal{H}\)</span>, si on peut définir <span class="math inline">\(f_h\)</span> tel que <span class="math display">\[\mathcal{A} f_h(w) = h(w) - \int h(z) \phi(z) \mathrm{d}z\, ,\]</span> on a <span class="math display">\[
\mathbb{E}_Q h(W) - \mathbb{E}_{\mathcal{N}(0,1)} h(Z) = \mathbb{E}_Q \mathcal{A} f_h(W) \, .
\]</span> In order to upper bound <span class="math inline">\(d_{\mathcal{H}}(Q, \mathcal{N}(0,1))\)</span>, it suffices to upper bound the following collection of expectations: <span class="math display">\[
\mathbb{E}_Q \mathcal{A} f_h(W) \qquad\text{for} h \in \mathcal{H}, \text{ and } \mathcal{A} f_h(w) = h(w) - \int h(z) \phi(z) \mathrm{d}z \, .
\]</span> This last goal led to the development of creative methods for approximating integrals. In order to understand what is at stake, we have to investigate the smoothness and boundedness properties of functions <span class="math inline">\(\mathcal{A} f_h, h \in \mathcal{H}\)</span>, when <span class="math inline">\(\mathcal{H}\)</span> itself is defined by smoothness constraints.</p>
<p>In the sequel, we abbreviate <span class="math inline">\(\int_{\mathbb{R}}  h(z) \phi(z)\mathrm{d}z\)</span> to <span class="math inline">\(\Phi(h)\)</span>.</p>
<div id="lem-ode1" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 11.1</strong></span> Let <span class="math inline">\(f_h\)</span> be the solution of the differential equation <span class="math display">\[
f'_h(w) - w f_h(w) =  h(w) - \Phi(h)\, .
\]</span> given by <span class="math display">\[
f_h(w) = \begin{cases}
\mathrm{e}^{w^2/2} \int_w^\infty \mathrm{e}^{-t^2/2}(\Phi(h)-h(t)) \mathrm{d}t &amp; \text{if } w \geq 0 \\
\mathrm{e}^{w^2/2} \int^w_{-\infty} \mathrm{e}^{- t^2/2} \left(h(t) -\Phi(h)\right) \mathrm{d}t &amp; \text{if } w \leq 0  \,.
\end{cases}
\]</span> If <span class="math inline">\(h\)</span> is absolutely continuous then <span class="math inline">\(f_h\)</span> is the only bounded solution of the differential equation and <span class="math display">\[
\|f_h\|_\infty \leq 2 \|h'\|_\infty,\qquad \|f'_h\|_\infty \leq \sqrt{\frac{2}{\pi}}\|h'\|_\infty,\qquad\|f^{\prime\prime}_h\|_\infty \leq 2\|h'\|_\infty \, .
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We first check that <span class="math inline">\(f_h\)</span> is the unique bounded solution of the differential equation,</p>
<p>Note that adding a constant to <span class="math inline">\(h\)</span> leaves <span class="math inline">\(h - \Phi(h)\)</span> invariant. So we assume <span class="math inline">\(h(0)=0\)</span>. We have <span class="math inline">\(|h(w)| \leq \|h'\|_{\infty} |w|\)</span>.</p>
<p>For <span class="math inline">\(w&gt;0\)</span>, observe <span class="math display">\[
\mathrm{e}^{w^2/2} \int_w^{\infty} t \, \mathrm{e}^{-t^2/2}  \mathrm{d}t
= 1 \qquad
\Phi(|h|) \leq \| h' \|_\infty \sqrt{\frac{2}{\pi}}
\, .
\]</span> Function <span class="math inline">\(w \mapsto \mathrm{e}^{w^2/2}\)</span> satisfies the differential equation. Now look for a bounded solution like <span class="math display">\[
f(w) = g(w) \mathrm{e}^{w^2/2} \, .
\]</span> The differential equation reads <span class="math display">\[
g'(w) = \mathrm{e}^{- w^2/2} \left(h(w) - \Phi(h)\right) \, .
\]</span> A solution is provied by function <span class="math display">\[
g(w) =  \begin{cases}
\int_w^\infty \mathrm{e}^{- t^2/2} \left(\Phi(h) -h(t)\right) \mathrm{d}t &amp; \text{if } w\geq 0 \\
\int^w_{-\infty} \mathrm{e}^{- t^2/2} \left(h(t) -\Phi(h)\right) \mathrm{d}t &amp; \text{if } w\leq 0 \, .
\end{cases}
\]</span> (integrability assumptions about <span class="math inline">\(h\)</span> warrant that <span class="math inline">\(g\)</span> is well-defined), hence <span class="math inline">\(f_h\)</span> is a solution of the differential equation stated in Lemma <a href="#lem-ode1" class="quarto-xref">Lemma&nbsp;<span>11.1</span></a></p>
<p>Besides, for <span class="math inline">\(w&gt;0\)</span> <span class="math display">\[
f_h(w) = g(w) \mathrm{e}^{w^2/2} \leq \| h'\|_\infty \left(\sqrt{\frac{2}{\pi}}\frac{\overline{\Phi}(w)}{\phi(w)} +1 \right) \, ,
\]</span> the ratio <span class="math inline">\(\frac{\overline{\Phi}(w)}{\phi(w)}\)</span> is non-increasing over <span class="math inline">\([0, \infty)\)</span>, it is always smaller than <span class="math inline">\(\sqrt{\frac{\pi}{2}}\)</span>. The boundedness of <span class="math inline">\(f_h\)</span> follows: <span class="math display">\[
\| f_h \|_\infty \leq 2   \|h'\|_\infty  \, .
\]</span> The other solutions of the differential equation are <span class="math inline">\(f_h + c \mathrm{e}^{w^2/2}\)</span>. They are not bounded.</p>
<p>Les us now bound the first and second derivatives of <span class="math inline">\(f_h\)</span>.</p>
<p>We first check <span class="math display">\[\begin{align*}
h(w) - \Phi(h)  &amp; = \int_{-\infty}^w h'(t) \Phi(t) \mathrm{d}t - \int_w^\infty h'(t) \overline{\Phi}(t) \mathrm{d}t \,.
\end{align*}\]</span> Plugging into the definition de <span class="math inline">\(f_h\)</span>, we get : <span class="math display">\[\begin{align*}
f_h(w) &amp; =  - \sqrt{2\pi} \mathrm{e}^{w^2/2} (1-\Phi(w)) \int_{-\infty}^w h'(t) \Phi(t) \mathrm{d}t \\
&amp; \phantom{=} - \sqrt{2\pi} \mathrm{e}^{w^2/2} \Phi(w) \int_w^{\infty}  h'(t) (1-\Phi(t)) \mathrm{d}t
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
f'_h(w)
&amp; = w f_h(w)  + h(w) -\Phi(h) \\
&amp; = (1 - \sqrt{2\pi} \mathrm{e}^{w^2/2} (1-\Phi(w)))\int_{-\infty}^w h'(t) \Phi(t) \mathrm{d}t \\
&amp; \phantom{=} - (1 + \sqrt{2\pi} \mathrm{e}^{w^2/2} \Phi(w)) \int_w^{\infty}  h'(t) (1-\Phi(t)) \mathrm{d}t\\
\end{align*}\]</span> hence <span class="math display">\[\begin{align*}
|f'_h(w)|
&amp; \leq \|h'\|_\infty \sup_{w \in \mathbb{R}} \Big(|1 - \sqrt{2\pi} \mathrm{e}^{w^2/2} (1-\Phi(w))|\int_{\infty}^w \Phi(t) \mathrm{d}t \Big. \\
&amp; \phantom{\leq \|h'\|_\infty \sup_{w \in \mathbb{R}} \Big( \Big.)} \Big. |1 + \sqrt{2\pi} \mathrm{e}^{w^2/2} \Phi(w)| \int_w^{\infty}   (1-\Phi(t))\Big)
\end{align*}\]</span> To complete the upper bound on <span class="math inline">\(\|f'_h\|_\infty\)</span>, it suffices to bound the supremum as <span class="math inline">\(w\)</span> varies.</p>
<p>To establish existence and boundedness of the second derivative, we differentiate <span class="math inline">\(f'_h(w)  = w f_h(w)  + h(w) -\Phi(h)\)</span> to get <span class="math display">\[\begin{align*}
f^{\prime\prime}_h(w)
&amp; = f_h(w) + w f'_h(w) + h'(w) \\
&amp; = (1+ w^2)f_h(w) + ww (h(w) - \Phi(h)) + h'(w) \, .
\end{align*}\]</span> On réutilise les calculs esquissés précédemment pour majorer <span class="math inline">\(\|f^{\prime\prime}_h\|_\infty\)</span>.</p>
<p><span class="math inline">\(\square\)</span></p>
</div>
<p>Le fait que si <span class="math inline">\(h\)</span> est <span class="math inline">\(1\)</span>-Lipschitz, <span class="math inline">\(f_h\)</span> soit deux fois dérivable et de dérivée seconde bounded is convenient lorsqu’il faut majorer <span class="math inline">\(\mathbb{E} \mathcal{A}f_h(W)\)</span>. La façon dont on peut tirer avantage de cette régularité dépend de ce qu’on sait sur la structure de <span class="math inline">\(W\)</span>. Le theorem suivant qui peut être vu comme une combinaison des theorems de Berry-Esseen et de Lindeberg-Feller, montre ce qui peut etre obtenu lorsque <span class="math inline">\(W\)</span> est une somme de variables aléatoires indépendantes pas nécessairement identique distribuées, centrées et suffisamment intégrables.</p>
</section>
<section id="sec-secBerryLindeberg" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="sec-secBerryLindeberg"><span class="header-section-number">11.6</span> A Berry-Esseen bound for a Lindeberg-Feller-like Central Limit Theorem</h2>
<p>Le theorem suivant peut etre lu comme un résultat intermédiaire entre le theorem de Berry-Esseen <span class="quarto-unresolved-ref">?thm-tcl-berry</span> (il donne une distance à la loi normale) et le theorem central limite de Lindeberg-Feller <span class="quarto-unresolved-ref">?thm-tcl-lindeberg</span> (il traite de sommes de variables aléatoires indépendantes mais pas nécessairement identiquement distribuées). Les conditions utilisées ici sont plus fortes que celles décrites dans les deux theorems précédents. Dans le theorem de Lindeberg-Feller, la condition d’intégrabilité uniforme est minimale. Dans l’énoncé du theorem de Berry-Esseen, on se contente de postuler que les summands have a finite third moment. Ici on suppose un peu plus: les summands ont un kurtosis bounded.</p>
<p>Rappelons que le kurtosis d’une loi est défini par <span class="math display">\[
\frac{\mathbb{E}[(X -\mathbb{E}X)^4]}{(\mathbb{E}[(X -\mathbb{E}X)^2])^2} \, .
\]</span></p>
<p>The kurtosis of Gausian est toujours égal à <span class="math inline">\(3\)</span>. Pour les lois Gamma, le kurtosis ne dépend que du paramètre de forme <span class="math inline">\(p\)</span> (il vaut <span class="math inline">\(3+ 6/p\)</span>).</p>
<div id="thm">
<p>Soient <span class="math inline">\(X_1, \ldots, X_n\)</span> des variables aléatoires indépendantes centrées, de kurtosis majoré par <span class="math inline">\(\kappa\)</span>. On définit <span class="math inline">\(\sigma^2 = \sum_{i=1}^n  \operatorname{var}\left(X_i\right)\)</span> et <span class="math inline">\(W = \sum_{i=1}^n X_i / \sigma\)</span>. <span class="math display">\[
\mathrm{d}_M(\mathcal{L}(W), \mathcal{N}(0, 1))
\leq \sqrt{\frac{2}{\pi}}
\left(\frac{1}{\sigma^3} \sum_{i=1}^n \mathbb{E}|X_i|^3
+ \sqrt{\kappa \sum_{i=1}^n \frac{\operatorname{var}(X_i)^2}{\left(\sum_{i=1}^n \operatorname{var}(X_i)\right)^2}} \right) \, .
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em> (Proof of <span class="quarto-unresolved-ref">?thm-lindeberg-feller-stein</span>). </span>Dans la preuve <span class="math inline">\(h\)</span> est une fonction <span class="math inline">\(1\)</span>-Lipschitzienne, <span class="math inline">\(f\)</span> la solution bounded <span class="math inline">\(\mathcal{A} f = h - \Phi(h)\)</span>. Pour majorer <span class="math inline">\(\mathbb{E} h(W) - \Phi(h)\)</span>, on va majorer <span class="math inline">\(|\mathbb{E} [f'_h(W) -W f(W)]|\)</span>.</p>
<p>Dans la suite, pour <span class="math inline">\(i \in 1, \ldots, n\)</span>, <span class="math inline">\(W_i = \sum_{j\neq i} X_j/\sigma\)</span>.</p>
<p>Observe first that as <span class="math inline">\(W_i\)</span> and <span class="math inline">\(X_i\)</span> are independent and centered <span class="math display">\[
\mathbb{E}[X_i f(W_i)]  = 0 \, .
\]</span></p>
<p><span class="math display">\[\begin{align*}
  \mathbb{E}[W f(W)] &amp; =  \mathbb{E}\left[ \frac{1}{\sigma}\sum_{i=1}^n X_i f(W)\right] \\
  &amp; =   \mathbb{E}\left[ \frac{1}{\sigma}\sum_{i=1}^n (X_i f(W) - X_i f(W_i))\right] \\
  &amp; =  \mathbb{E}\left[ \frac{1}{\sigma}\sum_{i=1}^n X_i (f(W)- f(W_i))\right] \, .
\end{align*}\]</span> In the sequel, we will rely on <span class="math display">\[\begin{align*}
  \mathbb{E}[W f(W)] &amp; = \mathbb{E}\left[ \frac{1}{\sigma}\sum_{i=1}^n X_i (f(W)- f(W_i) - (W- W_i) f'(W)) \right] \\
  &amp; \phantom{====} + \mathbb{E}\left[ \frac{1}{\sigma}\sum_{i=1}^n X_i ((W- W_i) f'(W)) \right] \, .
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\left| \mathbb{E}[f'(W) - W f(W)]\right| &amp; \leq
\underbrace{\left| \mathbb{E}\left[ \frac{1}{\sigma}\sum_{i=1}^n X_i (f(W)- f(W_i) - (W- W_i) f'(W)) \right] \right|}_{\textsf{(i)}}\\
&amp; \phantom{====} +
\underbrace{\left|\mathbb{E}\left[ \left( 1-\frac{1}{\sigma}\sum_{i=1}^n X_i (W- W_i)\right) f'(W) \right] \right|}_{\textsf{(i)}} \, .
\end{align*}\]</span></p>
<p>To upper bound , l’inégalité des accroissements finis suffit <span class="math display">\[\begin{align*}
\textsf{(i)} &amp;  \leq   \mathbb{E}\left[ \frac{1}{\sigma}\sum_{i=1}^n |X_i|  \left|f(W)- f(W_i) - (W- W_i) f'(W)\right| \right]  \\
&amp; \leq \frac{1}{\sigma}\sum_{i=1}^n\mathbb{E}\left[ |X_i|
  \frac{|X_i|^2}{\sigma^2} \| f^{\prime\prime}\|_\infty \right]  \\
&amp; \leq {\| f^{\prime\prime}\|_\infty}\frac{\sum_{i=1}^n\mathbb{E} |X_i|^3  }{\sigma^3} \, .
\end{align*}\]</span> Pour majorer , on utilise Cauchy-Schwarz et l’hypothèse de kurtosis. <span class="math display">\[\begin{align*}
\textsf{(ii)} &amp; \leq  \mathbb{E}\left[ \left|\left( 1-\frac{1}{\sigma^2}\sum_{i=1}^n X^2_i \right)\right| \left|f'(W)\right| \right] \\
&amp; \leq \|f'\|_\infty \mathbb{E}\left[ \left|\left( 1-\frac{1}{\sigma^2}\sum_{i=1}^n X^2_i \right)\right|\right] \\
&amp; \leq \|f'\|_\infty \frac{1}{\sigma^2} \left(\sum_{i=1}^n \operatorname{var}(X_i^2)\right)^{1/2} \\
&amp; \leq \|f'\|_\infty \frac{1}{\sigma^2} \left(\kappa \sum_{i=1}^n \operatorname{var}(X_i)^2\right)^{1/2}  \\
&amp; \leq \|f'\|_\infty  \left(\kappa \sum_{i=1}^n \left( \frac{\operatorname{var}(X_i)}{\sum_{i=1}^n \operatorname{var}(X_i)} \right)^2\right)^{1/2}
\end{align*}\]</span></p>
<p><span class="math inline">\(\square\)</span></p>
</div>
<p>En utilisant le fait que pour <span class="math inline">\(X\)</span> centrée, de kurtosis <span class="math inline">\(\kappa\)</span> <span class="math display">\[
\mathbb{E} |X_i|^3 \leq (\mathbb{E} |X_i|^4)^{3/4} \leq \kappa^{3/4}
(\mathbb{E} |X_i|^2)^{3/2} \, ,
\]</span></p>
<p>le membre droit du majorant peut se majorer lui même en <span class="math display">\[
\kappa^{3/4} \|f^{\prime\prime}\|_\infty\left(\sum_{i=1}^n \left(\frac{\operatorname{var}(X_i)}{\sum_{j=1}^n \operatorname{var}(X_j)}\right)^{3/2}\right) +
\kappa^{1/2} \|f'\|_\infty
\left( \sum_{i=1}^n \left( \frac{\operatorname{var}(X_i)}{\sum_{i=1}^n \operatorname{var}(X_i)} \right)^2\right)^{1/2}
\]</span></p>
<p>Si les <span class="math inline">\(X_i\)</span> sont identiquement distribuées, alors le majorant du theorem s’écrit <span class="math display">\[
\sqrt{\frac{2}{\pi}} \frac{1}{\sqrt{n}} \left( \kappa^{3/4} + \kappa^{1/2} \right)  \, .
\]</span></p>
<!-- ::: {#fig-quantcltbinom2} -->
<div class="cell">
<div class="cell-output-display">
<div id="fig-quantcltbinom2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-quantcltbinom2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="08-convergence-3b_files/figure-html/fig-quantcltbinom2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-quantcltbinom2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.2: Kolmogorov distance between standard Gaussian and distribution of <span class="math inline">\((X_n - np)/\sqrt{np(1-p}\)</span> with <span class="math inline">\(X_n\)</span> binomially distributed with parameters <span class="math inline">\(n\)</span> and <span class="math inline">\(p=.3\)</span>. The rate of convergence in the central limit theorem is asymptotically of order <span class="math inline">\(1/\sqrt{n}\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<!-- ::: -->
</section>
<section id="bibliographic-remarks" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="bibliographic-remarks"><span class="header-section-number">11.7</span> Bibliographic remarks</h2>
<p>La possibilité de métriser la convergence en distribution (et la convergence en probabilité) est traitée avec beaucoup de rigueur et de clarté dans <span class="citation" data-cites="MR1932358">(<a href="#ref-MR1932358" role="doc-biblioref">Dudley, 2002</a>)</span>.</p>
<p>Stein’s method pour établir des versions précises et générales du theorem central limite est décrite dans <span class="citation" data-cites="2011arXiv1109.1880R">(<a href="#ref-2011arXiv1109.1880R" role="doc-biblioref">Ross, 2011</a>)</span>.</p>
<p>A thorough yet readable treatment of Stein’s method is <span class="citation" data-cites="MR2732624">(<a href="#ref-MR2732624" role="doc-biblioref">Chen, Goldstein, &amp; Shao, 2011</a>)</span>.</p>
<p>[Section ]) follows the first pages of <span class="citation" data-cites="2011arXiv1109.1880R">(<a href="#ref-2011arXiv1109.1880R" role="doc-biblioref">Ross, 2011</a>)</span></p>
<p>La démonstration complète du <span class="quarto-unresolved-ref">?lem-regu-stein</span>} se trouve dans <span class="citation" data-cites="MR2732624">(<a href="#ref-MR2732624" role="doc-biblioref">Chen et al., 2011</a>)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-MR2732624" class="csl-entry" role="listitem">
Chen, L. H. Y., Goldstein, L., &amp; Shao, Q.-M. (2011). <em>Normal approximation by <span>S</span>tein’s method</em> (p. xii+405). Springer, Heidelberg. <a href="https://doi.org/10.1007/978-3-642-15007-4">https://doi.org/10.1007/978-3-642-15007-4</a>
</div>
<div id="ref-MR1932358" class="csl-entry" role="listitem">
Dudley, R. M. (2002). <em>Real analysis and probability</em> (Vol. 74, p. x+555). Cambridge: Cambridge University Press.
</div>
<div id="ref-2011arXiv1109.1880R" class="csl-entry" role="listitem">
Ross, N. (2011). <span class="nocase">Fundamentals of Stein’s method</span>. <em>ArXiv e-Prints</em>. Retrieved from <a href="https://arxiv.org/abs/1109.1880">https://arxiv.org/abs/1109.1880</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./08-convergence-3.html" class="pagination-link" aria-label="Convergence in distribution">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Convergence in distribution</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-gaussian-vectors.html" class="pagination-link" aria-label="Gaussian vectors">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Gaussian vectors</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>